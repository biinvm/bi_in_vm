<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Аналитика продаж</title>
  <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: white;
      color: #333;
      height: 100vh;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .top-bar {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 15px;
      background: #f8f9fa;
      border-bottom: 1px solid #dee2e6;
      position: sticky;
      top: 0;
      z-index: 100;
      min-height: 70px;
    }

    .date-controls {
      display: flex;
      align-items: center;
      gap: 10px;
      background: white;
      padding: 10px 20px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      border: 1px solid #e0e0e0;
    }

    .date-input {
      padding: 10px 15px;
      border: 2px solid #ddd;
      border-radius: 6px;
      font-size: 14px;
      min-width: 140px;
      transition: border-color 0.2s;
    }

    .date-input:focus {
      outline: none;
      border-color: #5470c6;
    }

    .apply-btn {
      background: #6a11cb;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
      white-space: nowrap;
      box-shadow: 0 2px 4px rgba(106, 17, 203, 0.2);
    }

    .apply-btn:hover {
      background: #5a0db3;
      transform: translateY(-1px);
      box-shadow: 0 4px 8px rgba(106, 17, 203, 0.3);
    }

    .apply-btn:active {
      transform: translateY(0);
      box-shadow: 0 2px 4px rgba(106, 17, 203, 0.2);
    }

    .chart-container {
      flex: 1;
      min-height: 0;
      padding: 20px;
      overflow: hidden;
    }

    #main {
      width: 100%;
      height: 100%;
      min-height: 300px;
    }

    .date-separator {
      color: #666;
      font-size: 16px;
      font-weight: 500;
    }

    /* Адаптивность для планшетов и телефонов */
    @media (max-width: 768px) {
      .top-bar {
        flex-direction: column;
        gap: 15px;
        padding: 15px 10px;
        min-height: auto;
        justify-content: flex-start;
      }

      .date-controls {
        width: 100%;
        flex-direction: column;
        gap: 10px;
        padding: 15px;
      }

      .date-input {
        width: 100%;
        min-width: auto;
        text-align: center;
      }

      .apply-btn {
        width: 100%;
      }

      .date-separator {
        display: none;
      }

      .chart-container {
        padding: 15px 10px;
        padding-top: 10px;
      }
    }

    @media (max-width: 480px) {
      .top-bar {
        padding: 12px 8px;
        gap: 12px;
      }

      .date-controls {
        padding: 12px;
      }

      .date-input {
        padding: 12px;
        font-size: 13px;
      }

      .apply-btn {
        padding: 12px;
        font-size: 13px;
      }

      .chart-container {
        padding: 12px 8px;
        padding-top: 8px;
      }
    }

    /* Ландшафтная ориентация */
    @media (orientation: landscape) and (max-height: 600px) {
      .top-bar {
        padding: 10px;
        min-height: 60px;
      }

      .chart-container {
        padding: 15px;
        padding-top: 10px;
      }

      .date-controls {
        padding: 8px 15px;
      }

      .date-input {
        padding: 8px 12px;
        font-size: 13px;
        min-width: 120px;
      }

      .apply-btn {
        padding: 8px 15px;
        font-size: 13px;
      }
    }
  </style>
</head>

<body>
  <!-- Верхняя панель с выбором периода -->
  <div class="top-bar">
    <div class="date-controls">
      <input type="date" id="start-date" class="date-input">
      <span class="date-separator">—</span>
      <input type="date" id="end-date" class="date-input">
      <button class="apply-btn" onclick="updateChart()">Применить</button>
    </div>
  </div>

  <!-- Контейнер для графика -->
  <div class="chart-container">
    <div id="main"></div>
  </div>

  <script>
    // Данные продуктов
    const products = {
      "0025-11-29": {
        "Индивидуальная программа \"Отдел тайн\" на 3 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 53640.0
        }
      },
      "2025-05-26": {
        "Выпускной до 35ч \"Трактир\" , Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 30000.0
        }
      },
      "2025-08-05": {
        "Семейный билет на трех студентов Академии": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 4600.0
        }
      },
      "2025-08-16": {
        "Оплата по смете праздника": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 15000.0
        }
      },
      "2025-08-21": {
        "Оплата по смете праздника": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 3340.0
        },
        "Единый билет, 2 чел.": {
          "записей": 1,
          "единиц": 2.0,
          "сумма": 5600.0
        },
        "Чаепитие классик \"Ханс\" до 5 гостей": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 8900.0
        }
      },
      "2025-08-23": {
        "Оплата по смете праздника": {
          "записей": 4,
          "единиц": 4.0,
          "сумма": 42590.0
        },
        "Чаепитие дизайнерский \"Густав\" до 8 гостей": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 20500.0
        },
        "Выходной 2600 - Билет студент Академии волшебства": {
          "записей": 1,
          "единиц": 2.0,
          "сумма": 4420.0
        },
        "Семейный билет на трёх студентов Академии, выходной день": {
          "записей": 2,
          "единиц": 12.0,
          "сумма": 72000.0
        },
        "Услуги фотографа 2 часа": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 15000.0
        },
        "Аренда банкетного зала \"Таверна\", 3 часа": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 81920.0
        }
      },
      "2025-08-24": {
        "Оплата по смете праздника": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 94230.0
        },
        "Взрослый депозит": {
          "записей": 1,
          "единиц": 5.0,
          "сумма": 5000.0
        },
        "Чаепитие классик \"Ханс\" до 5 гостей": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 8900.0
        },
        "Семейный билет на трёх студентов Академии, выходной день": {
          "записей": 1,
          "единиц": 3.0,
          "сумма": 17100.0
        }
      },
      "2025-08-28": {
        "Оплата по смете праздника": {
          "записей": 3,
          "единиц": 3.0,
          "сумма": 73274.0
        },
        "Волшебная палочка Визардия": {
          "записей": 2,
          "единиц": 6.0,
          "сумма": 7800.0
        },
        "Пакетное предложение \"Отдел Тайн\", 3 часа": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 28000.0
        }
      },
      "2025-08-29": {
        "Оплата по смете праздника": {
          "записей": 6,
          "единиц": 6.0,
          "сумма": 32900.0
        },
        "Пакетное предложение \"Отдел Тайн\", 3 часа": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 53650.0
        },
        "Чаепитие классик \"Густав\" до 8 гостей": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 23400.0
        },
        "Будни 1900 - Билет студент Академии волшебства": {
          "записей": 2,
          "единиц": 9.0,
          "сумма": 14535.0
        },
        "Единый билет, 2 чел.": {
          "записей": 3,
          "единиц": 12.0,
          "сумма": 33600.0
        },
        "Чаепитие дизайнерский \"Густав\" до 8 гостей": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 20500.0
        },
        "Чаепитие классик \"Ханс\" до 5 гостей": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 8900.0
        }
      },
      "2025-08-30": {
        "Оплата по смете праздника": {
          "записей": 9,
          "единиц": 9.0,
          "сумма": 272120.0
        },
        "Услуги фотографа 2 часа": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 15000.0
        },
        "Волшебная палочка Визардия": {
          "записей": 2,
          "единиц": 5.0,
          "сумма": 6500.0
        },
        "Чаепитие дизайнерский \"Ханс\" до 5 гостей": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 16500.0
        },
        "Выходной 2600 - Билет студент Академии волшебства": {
          "записей": 2,
          "единиц": 3.0,
          "сумма": 6630.0
        },
        "Семейный билет на трёх студентов Академии, выходной день": {
          "записей": 2,
          "единиц": 3.0,
          "сумма": 18000.0
        },
        "Пакетное предложение \"Отдел Тайн\", 3 часа": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 53650.0
        },
        "Чаепитие классик \"Ханс\" до 5 гостей": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 8900.0
        },
        "Чаепитие классик \"Густав\" до 8 гостей": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 11700.0
        }
      },
      "2025-08-31": {
        "Оплата по смете праздника": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 11190.0
        }
      },
      "2025-09-01": {
        "Чаепитие классик \"Ханс\" до 5 гостей": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 8900.0
        },
        "Единый билет, 2 чел.": {
          "записей": 1,
          "единиц": 2.0,
          "сумма": 5600.0
        },
        "Будни 1900 - Билет студент Академии волшебства": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 1615.0
        }
      },
      "2025-09-04": {
        "Выходной 2600 - Билет студент Академии волшебства": {
          "записей": 1,
          "единиц": 5.0,
          "сумма": 11050.0
        }
      },
      "2025-09-05": {
        "Оплата по смете праздника": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 18650.0
        },
        "Чаепитие классик \"Густав\" до 8 гостей": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 12700.0
        },
        "Будни 1900 - Билет студент Академии волшебства": {
          "записей": 1,
          "единиц": 7.0,
          "сумма": 11305.0
        }
      },
      "2025-09-06": {
        "Оплата по смете праздника": {
          "записей": 6,
          "единиц": 6.0,
          "сумма": 270770.0
        },
        "Аниматор (1 аниматор, 1 час)": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 8000.0
        },
        "Выходной 2600 - Билет студент Академии волшебства": {
          "записей": 3,
          "единиц": 3.0,
          "сумма": 6630.0
        },
        "Чаепитие дизайнерский \"Ханс\" до 5 гостей": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 32000.0
        },
        "Чаепитие классик \"Густав\" до 8 гостей": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 12700.0
        },
        "Семейный билет на трёх студентов Академии, выходной день": {
          "записей": 2,
          "единиц": 5.0,
          "сумма": 30000.0
        },
        "Чаепитие классик \"Феликс\" до 12 гостей": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 18900.0
        }
      },
      "2025-09-07": {
        "Оплата по смете праздника": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 25700.0
        },
        "Волшебная палочка Визардия": {
          "записей": 2,
          "единиц": 14.0,
          "сумма": 18200.0
        },
        "Услуги фотографа 2 часа": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 30000.0
        },
        "Пакетное предложение \"Отдел Тайн\", 3 часа": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 53650.0
        },
        "Шар фольгированный цифра": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 2500.0
        },
        "Шар латексный": {
          "записей": 1,
          "единиц": 10.0,
          "сумма": 2500.0
        },
        "Будни 1900 - Билет студент Академии волшебства": {
          "записей": 1,
          "единиц": 8.0,
          "сумма": 12920.0
        },
        "Аренда банкетного зала \"Таверна\", 3 часа": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 60000.0
        }
      },
      "2025-09-12": {
        "Оплата по смете праздника": {
          "записей": 3,
          "единиц": 3.0,
          "сумма": 20740.0
        },
        "Чаепитие классик \"Густав\" до 8 гостей": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 13700.0
        },
        "Дополнительный именинник + подарок": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 500.0
        },
        "Бумажная дискотека \"Оптима. Белая\"": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 40000.0
        },
        "Аниматор (1 аниматор, 1 час)": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 8000.0
        },
        "Услуги фотографа 2 часа": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 15000.0
        },
        "Чаепитие классик \"Рупперт\" до 15 гостей": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 22700.0
        },
        "Семейный билет на трех студентов Академии": {
          "записей": 2,
          "единиц": 14.0,
          "сумма": 64400.0
        },
        "Чаепитие классик \"Феликс\" до 12 гостей": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 15920.0
        },
        "Пакетное предложение \"Отдел Тайн\", 3 часа": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 53650.0
        }
      },
      "2025-09-13": {
        "Волшебная палочка Визардия": {
          "записей": 1,
          "единиц": 12.0,
          "сумма": 15600.0
        },
        "Оплата по смете праздника": {
          "записей": 4,
          "единиц": 4.0,
          "сумма": 155170.0
        },
        "Чаепитие классик \"Ханс\" до 5 гостей": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 18800.0
        },
        "Семейный билет на трёх студентов Академии, выходной день": {
          "записей": 3,
          "единиц": 4.0,
          "сумма": 24000.0
        },
        "Чаепитие классик \"Густав\" до 8 гостей": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 12700.0
        },
        "Выходной 2600 - Билет студент Академии волшебства": {
          "записей": 3,
          "единиц": 18.0,
          "сумма": 39780.0
        },
        "Чаепитие классик \"Рупперт\" до 15 гостей": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 22700.0
        }
      },
      "2025-09-14": {
        "Оплата по смете праздника": {
          "записей": 5,
          "единиц": 5.0,
          "сумма": 162720.0
        },
        "Услуги фотографа 2 часа": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 15000.0
        },
        "Выходной 2400 - Билет студент Академии волшебства": {
          "записей": 1,
          "единиц": 30.0,
          "сумма": 70200.0
        }
      },
      "2025-09-18": {
        "Оплата по смете праздника": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 8390.0
        },
        "Чаепитие классик \"Рупперт\" до 15 гостей": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 22700.0
        },
        "Будни 1900 - Билет студент Академии волшебства": {
          "записей": 1,
          "единиц": 18.0,
          "сумма": 29070.0
        }
      },
      "2025-09-19": {
        "Будни 1900 - Билет студент Академии волшебства": {
          "записей": 1,
          "единиц": 4.0,
          "сумма": 6460.0
        },
        "Чаепитие дизайнерский \"Ханс\" до 5 гостей": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 16500.0
        },
        "Пакетное предложение \"Отдел Тайн\", 3 часа": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 35000.0
        },
        "Чаепитие классик \"Ханс\" до 5 гостей": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 9900.0
        }
      },
      "2025-09-20": {
        "Оплата по смете праздника": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 80060.0
        },
        "Выходной 2400 - Билет студент Академии волшебства": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 2040.0
        },
        "Чаепитие классик \"Феликс\" до 12 гостей": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 19900.0
        },
        "Семейный билет на трёх студентов Академии, выходной день": {
          "записей": 2,
          "единиц": 4.0,
          "сумма": 24000.0
        },
        "Единый билет, 2 чел.": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 4300.0
        },
        "Чаепитие классик \"Ханс\" до 5 гостей": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 19800.0
        },
        "Пакетное предложение \"Отдел Тайн\", 3 часа": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 35000.0
        },
        "Выходной 2600 - Билет студент Академии волшебства": {
          "записей": 1,
          "единиц": 5.0,
          "сумма": 11050.0
        }
      },
      "2025-09-21": {
        "Оплата по смете праздника": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 147680.0
        },
        "Пакетное предложение \"Отдел Тайн\", 3 часа": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 35000.0
        },
        "Будни 1900 - Билет студент Академии волшебства": {
          "записей": 1,
          "единиц": 2.0,
          "сумма": 2242.0
        }
      },
      "2025-09-25": {
        "Оплата по смете праздника, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 3048.0
        }
      },
      "2025-09-26": {
        "Билет студента академии волшебства Визардия, выходной день 2600": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 2210.0
        },
        "Чаепитие классик \"Феликс\" до 12 гостей": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 20500.0
        },
        "Семейный билет Визардия, выходной день на  на трёх студентов Академии": {
          "записей": 1,
          "единиц": 3.0,
          "сумма": 18000.0
        },
        "Семейный билет Визардия, будний день на  на трёх студентов Академии": {
          "записей": 1,
          "единиц": 2.0,
          "сумма": 9200.0
        },
        "Чаепитие классик \"Густав\" до 8 гостей Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 12700.0
        },
        "Оплата по смете праздника, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 98410.0
        },
        "Аниматор (1 аниматор, 1 час)": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 8000.0
        },
        "Аренда банкетного зала \"Трактир\", 3 часа": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 60000.0
        }
      },
      "2025-09-27": {
        "Оплата по смете праздника, Визардия": {
          "записей": 6,
          "единиц": 6.0,
          "сумма": 22420.0
        },
        "Билет студента академии волшебства Визардия, выходной день 2400": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 2400.0
        },
        "Семейный билет Визардия, выходной день на  на трёх студентов Академии": {
          "записей": 2,
          "единиц": 4.0,
          "сумма": 24000.0
        },
        "Билет студента академии волшебства Визардия, выходной день 2600": {
          "записей": 3,
          "единиц": 9.0,
          "сумма": 16770.0
        },
        "Чаепитие классик \"Густав\" до 8 гостей, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 12700.0
        },
        "Чаепитие классик \"Ханс\" до 5 гостей, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 9900.0
        },
        "Чаепитие классик \"Ханс\" до 5 гостей Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 9900.0
        },
        "Взрослый депозит": {
          "записей": 1,
          "единиц": 15.0,
          "сумма": 15000.0
        },
        "Чаепитие классик \"Феликс\" до 12 гостей": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 39800.0
        },
        "Чаепитие классик \"Густав\" до 8 гостей Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 12700.0
        },
        "Чаепитие дизайнерский \"Ханс\" до 5 гостей": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 16500.0
        },
        "Семейный билет на трёх студентов Академии, выходной день": {
          "записей": 4,
          "единиц": 11.0,
          "сумма": 66000.0
        },
        "Единый билет, 2 чел.": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 4300.0
        },
        "Выходной 2400 - Билет студент Академии волшебства": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 2040.0
        },
        "Чаепитие классик \"Густав\" до 8 гостей": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 12700.0
        },
        "Оплата по смете праздника": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 7260.0
        }
      },
      "2025-09-28": {
        "Оплата по смете праздника, Визардия": {
          "записей": 3,
          "единиц": 3.0,
          "сумма": 28530.0
        },
        "Билет студента академии волшебства Визардия, выходной день 2600": {
          "записей": 1,
          "единиц": 2.0,
          "сумма": 4420.0
        },
        "Пакетное предложение \"Отдел Тайн\", 3 часа": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 35000.0
        },
        "Дополнительный именинник + подарок": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 500.0
        },
        "Чаепитие классик \"Феликс\" до 12 гостей": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 19900.0
        },
        "Семейный билет на трёх студентов Академии, выходной день": {
          "записей": 1,
          "единиц": 4.0,
          "сумма": 24000.0
        }
      },
      "2025-09-30": {
        "Билет студента академии волшебства Визардия, будний день": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 3230.0
        },
        "Волшебная палочка, Визардия": {
          "записей": 1,
          "единиц": 8.0,
          "сумма": 10400.0
        },
        "Чаепитие классик \"Ханс\" до 5 гостей, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 11900.0
        },
        "Чаепитие классик \"Густав\" до 8 гостей, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 12700.0
        },
        "Семейный билет Визардия, будний день на  на трёх студентов Академии": {
          "записей": 1,
          "единиц": 2.0,
          "сумма": 9200.0
        }
      },
      "2025-10-02": {
        "Оплата по смете праздника, Визардия": {
          "записей": 1,
          "единиц": 15.0,
          "сумма": 8850.0
        },
        "Волшебная палочка, Визардия": {
          "записей": 1,
          "единиц": 15.0,
          "сумма": 19500.0
        },
        "Билет студента академии волшебства Визардия, будний день": {
          "записей": 1,
          "единиц": 15.0,
          "сумма": 19950.0
        }
      },
      "2025-10-04": {
        "Оплата по смете праздника, Визардия": {
          "записей": 4,
          "единиц": 4.0,
          "сумма": 36570.0
        },
        "Волшебная палочка, Визардия": {
          "записей": 3,
          "единиц": 13.0,
          "сумма": 16900.0
        },
        "Единый билет, 2 чел.": {
          "записей": 3,
          "единиц": 4.0,
          "сумма": 17200.0
        },
        "Чаепитие классик \"Густав\" до 8 гостей, Визардия": {
          "записей": 4,
          "единиц": 4.0,
          "сумма": 51250.0
        },
        "Услуги фотографа на 2 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 15000.0
        },
        "Индивидуальная программа \"Трактир\" на 3 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 76980.0
        },
        "Билет студента академии волшебства Визардия, выходной день 2400": {
          "записей": 1,
          "единиц": 2.0,
          "сумма": 4080.0
        },
        "Волшебная палочка ручной работы, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 5900.0
        },
        "Семейный билет Визардия, выходной день на  на трёх студентов Академии": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 6000.0
        },
        "Единый билет Визардия,выходной день на 2 студентов Академии": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 4300.0
        },
        "Индивидуальная программа \"Отдел тайн\" на 3 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 38740.0
        },
        "Чаепитие дизайнерский \"Ханс\" до 5 гостей Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 16500.0
        },
        "Семейный билет на трёх студентов Академии, выходной день": {
          "записей": 1,
          "единиц": 2.0,
          "сумма": 12000.0
        },
        "Пакетное предложение \"Отдел Тайн\", 3 часа": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 35000.0
        }
      },
      "2025-10-05": {
        "Оплата по смете праздника, Визардия": {
          "записей": 5,
          "единиц": 5.0,
          "сумма": 148550.0
        },
        "Волшебная палочка Визардия особенная": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 2200.0
        },
        "Волшебная палочка, Визардия": {
          "записей": 1,
          "единиц": 10.0,
          "сумма": 13000.0
        },
        "Билет студента академии волшебства Визардия, выходной день 2600": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 2210.0
        },
        "Индивидуальная программа \"Отдел тайн\" на 3 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 35000.0
        },
        "Пакетное предложение \"Отдел Тайн\", 3 часа": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 35000.0
        }
      },
      "2025-10-06": {
        "Волшебная палочка Визардия особенная": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 2200.0
        },
        "Волшебная палочка, Визардия": {
          "записей": 1,
          "единиц": 9.0,
          "сумма": 11700.0
        },
        "Оплата по смете праздника, Визардия": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 71978.0
        },
        "Индивидуальная программа \"Отдел тайн\" на 3 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 35000.0
        },
        "Индивидуальная программа \"Трактир\" на 3 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 70000.0
        }
      },
      "2025-10-09": {
        "Билет студента академии волшебства Визардия, будний день": {
          "записей": 1,
          "единиц": 2.0,
          "сумма": 2280.0
        },
        "Оплата по смете праздника, Визардия": {
          "записей": 1,
          "единиц": 6.0,
          "сумма": 6000.0
        },
        "Будни 1900 - Билет студент Академии волшебства": {
          "записей": 1,
          "единиц": 12.0,
          "сумма": 13680.0
        }
      },
      "2025-10-10": {
        "Оплата по смете праздника, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 23270.0
        },
        "Индивидуальная программа \"Отдел тайн\" на 3 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 35000.0
        }
      },
      "2025-10-11": {
        "Оплата по смете праздника, Визардия": {
          "записей": 3,
          "единиц": 3.0,
          "сумма": 67300.0
        },
        "Чаепитие классик \"Густав\" до 8 гостей, Визардия": {
          "записей": 3,
          "единиц": 3.0,
          "сумма": 37500.0
        },
        "Единый билет Визардия,выходной день на 2 студентов Академии": {
          "записей": 4,
          "единиц": 4.0,
          "сумма": 17200.0
        },
        "Семейный билет Визардия, выходной день на  на трёх студентов Академии": {
          "записей": 3,
          "единиц": 6.0,
          "сумма": 36000.0
        },
        "Индивидуальная программа \"Отдел тайн\" на 3 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 35000.0
        },
        "Волшебная палочка, Визардия": {
          "записей": 1,
          "единиц": 2.0,
          "сумма": 2600.0
        },
        "Пакетное предложение \"Отдел Тайн\", 3 часа": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 35000.0
        },
        "Волшебная палочка Визардия": {
          "записей": 1,
          "единиц": 6.0,
          "сумма": 7800.0
        }
      },
      "2025-10-12": {
        "Оплата по смете праздника, Визардия": {
          "записей": 4,
          "единиц": 4.0,
          "сумма": 50560.0
        },
        "Услуги фотографа на 2 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 15000.0
        },
        "Индивидуальная программа \"Отдел тайн\" на 3 часа, Визардия": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 53650.0
        },
        "Единый билет Визардия,выходной день на 2 студентов Академии": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 2262.0
        },
        "Семейный билет Визардия, выходной день на  на трёх студентов Академии": {
          "записей": 1,
          "единиц": 2.0,
          "сумма": 12000.0
        },
        "Чаепитие классик \"Ханс\" до 5 гостей, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 9000.0
        },
        "Волшебная палочка, Визардия": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 2600.0
        },
        "Единый билет, 2 чел.": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 8600.0
        },
        "Чаепитие классик \"Густав\" до 8 гостей, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 13750.0
        },
        "Пакетное предложение \"Отдел Тайн\", 3 часа": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 57000.0
        },
        "Семейный билет на трёх студентов Академии, выходной день": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 6000.0
        }
      },
      "2025-10-17": {
        "Оплата по смете праздника, Визардия": {
          "записей": 3,
          "единиц": 3.0,
          "сумма": 7145.0
        },
        "Чаепитие классик \"Ханс\" до 5 гостей, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 9000.0
        },
        "Единый билет Визардия, будний день на 2 студентов на 2 студентов Академии": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 3300.0
        },
        "Семейный билет Визардия, будний день на трёх студентов Академии": {
          "записей": 2,
          "единиц": 3.0,
          "сумма": 13800.0
        },
        "Чаепитие дизайнерский \"Ханс\" до 5 гостей, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 16000.0
        },
        "Билет студента академии волшебства Визардия, будний день": {
          "записей": 1,
          "единиц": 9.0,
          "сумма": 10089.0
        }
      },
      "2025-10-18": {
        "Оплата по смете праздника, Визардия": {
          "записей": 3,
          "единиц": 3.0,
          "сумма": 22780.0
        },
        "Индивидуальная программа \"Отдел тайн\" на 3 часа, Визардия": {
          "записей": 3,
          "единиц": 3.0,
          "сумма": 78110.0
        },
        "Индивидуальная программа  \"Таверна\" на 3 часа, Визардия": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 108620.0
        },
        "Чаепитие дизайнерский \"Густав\" до 8 гостей, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 18200.0
        },
        "Билет студента академии волшебства Визардия, выходной день 2600": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 2210.0
        },
        "Семейный билет Визардия, выходной день на  на трёх студентов Академии": {
          "записей": 1,
          "единиц": 2.0,
          "сумма": 12000.0
        },
        "Пакетное предложение \"Отдел Тайн\", 3 часа": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 35000.0
        }
      },
      "2025-10-19": {
        "Индивидуальная программа \"Отдел тайн\" на 3 часа, Визардия": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 64610.0
        },
        "Оплата по смете праздника, Визардия": {
          "записей": 2,
          "единиц": 15.0,
          "сумма": 32760.0
        },
        "Чаепитие дизайнерский \"Густав\" до 8 гостей, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 19500.0
        },
        "Семейный билет Визардия, выходной день на  на трёх студентов Академии": {
          "записей": 1,
          "единиц": 2.0,
          "сумма": 12000.0
        },
        "Пакетное предложение \"Отдел Тайн\", 3 часа": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 35000.0
        }
      },
      "2025-10-24": {
        "Волшебная палочка Визардия особенная": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 2200.0
        },
        "Волшебная палочка, Визардия": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 6500.0
        },
        "Чаепитие классик \"Густав\" до 8 гостей, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 12500.0
        },
        "Семейный билет Визардия, будний день на трёх студентов Академии": {
          "записей": 1,
          "единиц": 2.0,
          "сумма": 9200.0
        },
        "Депозит на гостя сверх пакета чаепития, Визардия": {
          "записей": 1,
          "единиц": 6.0,
          "сумма": 6000.0
        },
        "Билет студента академии волшебства Визардия, будний день": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 1615.0
        }
      },
      "2025-10-25": {
        "Торт Дизайнерский  2 кг № 22": {
          "записей": 1,
          "единиц": 2.0,
          "сумма": 10800.0
        },
        "Оплата по смете праздника, Визардия": {
          "записей": 4,
          "единиц": 4.0,
          "сумма": 88510.0
        },
        "Индивидуальная программа \"Трактир\" на 3 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 79500.0
        },
        "Индивидуальная программа \"Отдел тайн\" на 3 часа, Визардия": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 53650.0
        },
        "Продление индивидуальной программы на 1 час таверна/трактир, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 20000.0
        },
        "Аниматор (1 аниматор, 1 час, до 15 детей), Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 8000.0
        },
        "Услуги фотографа на 2 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 15000.0
        },
        "Волшебная палочка, Визардия": {
          "записей": 1,
          "единиц": 10.0,
          "сумма": 13000.0
        },
        "Депозит в ресторане Гри Холл, Визардия": {
          "записей": 1,
          "единиц": 20.0,
          "сумма": 24000.0
        },
        "Семейный билет Визардия, выходной день на  на трёх студентов Академии": {
          "записей": 1,
          "единиц": 4.0,
          "сумма": 24000.0
        },
        "Чаепитие классик \"Феликс\" до 12 гостей": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 20500.0
        }
      },
      "2025-10-26": {
        "Услуги фотографа на 2 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 15000.0
        },
        "Чаепитие классик \"Густав\" до 8 гостей, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 12500.0
        },
        "Единый билет Визардия,выходной день на 2 студентов Академии": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 4300.0
        },
        "Семейный билет Визардия, выходной день на  на трёх студентов Академии": {
          "записей": 2,
          "единиц": 4.0,
          "сумма": 24000.0
        },
        "Чаепитие классик \"Ханс\" до 5 гостей, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 9000.0
        },
        "Оплата по смете праздника, Визардия": {
          "записей": 1,
          "единиц": 12.0,
          "сумма": 12000.0
        },
        "Индивидуальная программа \"Отдел тайн\" на 3 часа, Визардия": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 38512.0
        }
      },
      "2025-10-31": {
        "Услуги фотографа на 2 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 15000.0
        },
        "Индивидуальная программа \"Отдел тайн\" на 3 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 53640.0
        }
      },
      "2025-11-01": {
        "Билет выходные на экскурсию в музей \"Чародейства и Волшебства\", Визардия": {
          "записей": 2,
          "единиц": 14.0,
          "сумма": 6930.0
        },
        "Оплата по смете праздника, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 15990.0
        }
      },
      "2025-11-02": {
        "Оплата по смете праздника, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 5030.0
        },
        "Латексный шар, 1 шт., Визардия": {
          "записей": 1,
          "единиц": 8.0,
          "сумма": 2000.0
        },
        "Чаепитие классик \"Густав\" до 8 гостей, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 12500.0
        },
        "Индивидуальная программа \"Отдел тайн\" на 3 часа, Визардия": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 61170.0
        },
        "Билет студента академии волшебства Визардия, выходной день 2400": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 2040.0
        }
      },
      "2025-11-03": {
        "Индивидуальная программа \"Отдел тайн\" на 3 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 35000.0
        }
      },
      "2025-11-04": {
        "Оплата по смете праздника, Визардия": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 64290.0
        },
        "Услуги фотографа на 2 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 15000.0
        },
        "Индивидуальная программа \"Отдел тайн\" на 3 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 35000.0
        }
      },
      "2025-11-06": {
        "Оплата по смете праздника, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 2740.0
        }
      },
      "2025-11-07": {
        "Оплата по смете праздника, Визардия": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 74100.0
        },
        "Услуги фотографа на 2 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 15000.0
        },
        "Чаепитие дизайнерский \"Густав\" до 8 гостей, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 19500.0
        },
        "Билет со скидкой, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 1615.0
        },
        "Семейный билет Визардия, будний день на трёх студентов Академии": {
          "записей": 1,
          "единиц": 2.0,
          "сумма": 9200.0
        },
        "Индивидуальная программа \"Отдел тайн\" на 3 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 35000.0
        }
      },
      "2025-11-08": {
        "Оплата по смете праздника, Визардия": {
          "записей": 3,
          "единиц": 3.0,
          "сумма": 58050.0
        },
        "Депозит на гостей сверх пакета чаепития, Визардия": {
          "записей": 1,
          "единиц": 4.0,
          "сумма": 4000.0
        },
        "Чаепитие классик \"Густав\" до 8 гостей, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 12500.0
        },
        "Индивидуальная программа \"Трактир\" на 3 часа, Визардия": {
          "записей": 3,
          "единиц": 3.0,
          "сумма": 127000.0
        },
        "Индивидуальная программа \"Отдел тайн\" на 3 часа, Визардия": {
          "записей": 3,
          "единиц": 3.0,
          "сумма": 88640.0
        },
        "Аниматор (1 аниматор, 1 час, до 15 детей), Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 8000.0
        },
        "Волшебная палочка, Визардия": {
          "записей": 1,
          "единиц": 12.0,
          "сумма": 15600.0
        },
        "Бумажная дискотека: Оптима, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 30000.0
        },
        "Индивидуальная программа  \"Таверна\" на 3 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 85000.0
        },
        "Семейный билет на трёх студентов Академии, выходной день": {
          "записей": 1,
          "единиц": 2.0,
          "сумма": 12000.0
        }
      },
      "2025-11-09": {
        "Оплата по смете праздника, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 8300.0
        },
        "Чаепитие классик \"Густав\" до 8 гостей, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 12500.0
        },
        "Билет студента академии волшебства Визардия, выходной день 2600": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 2210.0
        },
        "Семейный билет Визардия, выходной день на  на трёх студентов Академии": {
          "записей": 1,
          "единиц": 2.0,
          "сумма": 12000.0
        }
      },
      "2025-11-11": {
        "Единый билет Визардия, будний день на 2 студентов на 2 студентов Академии": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 3300.0
        },
        "Оплата по смете праздника, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 3600.0
        },
        "Чаепитие классик \"Густав\" до 8 гостей, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 12500.0
        },
        "Семейный билет Визардия, будний день на трёх студентов Академии": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 4600.0
        }
      },
      "2025-11-14": {
        "Оплата по смете праздника, Визардия": {
          "записей": 3,
          "единиц": 3.0,
          "сумма": 23710.0
        },
        "Индивидуальная программа \"Трактир\" на 3 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 26310.0
        },
        "Индивидуальная программа \"Отдел тайн\" на 3 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 20840.0
        },
        "Чаепитие классик \"Густав\" до 8 гостей, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 12500.0
        },
        "Билет студента академии волшебства Визардия, будний день": {
          "записей": 1,
          "единиц": 7.0,
          "сумма": 7847.0
        }
      },
      "2025-11-15": {
        "Оплата по смете праздника, Визардия": {
          "записей": 4,
          "единиц": 4.0,
          "сумма": 120540.0
        },
        "Индивидуальная программа \"Трактир\" на 3 часа, Визардия": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 88480.0
        },
        "Чаепитие классик \"Густав\" до 8 гостей, Визардия": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 25000.0
        },
        "Билет студента академии волшебства Визардия, выходной день 2400": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 2040.0
        },
        "Семейный билет Визардия, выходной день на  на трёх студентов Академии": {
          "записей": 3,
          "единиц": 5.0,
          "сумма": 30000.0
        },
        "Азот криошоу на 0,5 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 30000.0
        },
        "Индивидуальная программа  \"Таверна\" на 3 часа, Визардия": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 81920.0
        },
        "Индивидуальная программа \"Отдел тайн\" на 3 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 35000.0
        },
        "Билет со скидкой, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 2340.0
        },
        "Единый билет Визардия,выходной день на 2 студентов Академии": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 4300.0
        }
      },
      "2025-11-16": {
        "Оплата по смете праздника, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 2000.0
        },
        "Чаепитие классик \"Ханс\" до 5 гостей, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 9000.0
        },
        "Индивидуальная программа \"Отдел тайн\" на 3 часа, Визардия": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 53640.0
        }
      },
      "2025-11-18": {
        "Чаепитие классик \"Феликс\" до 12 гостей": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 20500.0
        },
        "Семейный билет Визардия, будний день на трёх студентов Академии": {
          "записей": 1,
          "единиц": 4.0,
          "сумма": 18400.0
        }
      },
      "2025-11-19": {
        "Волшебная палочка, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 1300.0
        },
        "Чаепитие классик \"Густав\" до 8 гостей, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 12500.0
        },
        "Билет со скидкой, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 1400.0
        },
        "Оплата по смете праздника, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 466.0
        },
        "Билет студента академии волшебства Визардия, будний день": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 1900.0
        },
        "Семейный билет Визардия, будний день на трёх студентов Академии": {
          "записей": 1,
          "единиц": 2.0,
          "сумма": 9200.0
        }
      },
      "2025-11-20": {
        "Оплата по смете праздника, Визардия": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 1720.0
        },
        "Чаепитие классик \"Ханс\" до 5 гостей, Визардия": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 18000.0
        },
        "Семейный билет Визардия, будний день на трёх студентов Академии": {
          "записей": 2,
          "единиц": 3.0,
          "сумма": 13800.0
        },
        "Единый билет Визардия, будний день на 2 студентов на 2 студентов Академии": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 3300.0
        }
      },
      "2025-11-21": {
        "Оплата по смете праздника, Визардия": {
          "записей": 3,
          "единиц": 3.0,
          "сумма": 54500.0
        },
        "Семейный билет Визардия, будний день на трёх студентов Академии": {
          "записей": 1,
          "единиц": 2.0,
          "сумма": 9200.0
        },
        "Чаепитие классик \"Ханс\" до 5 гостей, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 9000.0
        },
        "Шоу Собак Стиляг, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 58000.0
        },
        "Тесла-шоу на 0,5 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 30000.0
        },
        "Индивидуальная программа \"Отдел тайн\" на 3 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 35000.0
        }
      },
      "2025-11-22": {
        "Оплата по смете праздника, Визардия": {
          "записей": 5,
          "единиц": 5.0,
          "сумма": 69090.0
        },
        "Чаепитие классик \"Густав\" до 8 гостей, Визардия": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 25000.0
        },
        "Аниматор (1 аниматор, 1 час, до 15 детей), Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 8000.0
        },
        "Чаепитие классик \"Ханс\" до 5 гостей, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 9000.0
        },
        "Семейный билет Визардия, выходной день на  на трёх студентов Академии": {
          "записей": 2,
          "единиц": 3.0,
          "сумма": 18000.0
        },
        "Единый билет Визардия,выходной день на 2 студентов Академии": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 4300.0
        },
        "Депозит на заказ блюд в ресторане, Визардия": {
          "записей": 1,
          "единиц": 6.0,
          "сумма": 6000.0
        },
        "Индивидуальная программа \"Трактир\" на 3 часа, Визардия": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 110920.0
        },
        "Волшебная палочка, Визардия": {
          "записей": 2,
          "единиц": 9.0,
          "сумма": 11700.0
        },
        "Билет со скидкой, Визардия": {
          "записей": 2,
          "единиц": 10.0,
          "сумма": 18200.0
        },
        "Индивидуальная программа \"Отдел тайн\" на 3 часа, Визардия": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 70000.0
        },
        "Билет студента академии волшебства Визардия, выходной день 2600": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 2210.0
        }
      },
      "2025-11-23": {
        "Оплата по смете праздника, Визардия": {
          "записей": 3,
          "единиц": 3.0,
          "сумма": 128440.0
        },
        "Дополнительный именинник, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 500.0
        },
        "Чаепитие дизайнерский \"Феликс\" до 12 гостей, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 24000.0
        },
        "Услуги фотографа на 2 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 15000.0
        },
        "Аниматор (1 аниматор, 1 час, до 15 детей), Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 9500.0
        },
        "Семейный билет Визардия, выходной день на  на трёх студентов Академии": {
          "записей": 2,
          "единиц": 5.0,
          "сумма": 30000.0
        },
        "Билет студента академии волшебства Визардия, выходной день 2600": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 2210.0
        },
        "Индивидуальная программа \"Отдел тайн\" на 3 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 53640.0
        },
        "Фото на торт": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 500.0
        },
        "Депозит для взрослых на еду и напитки": {
          "записей": 1,
          "единиц": 4.0,
          "сумма": 4000.0
        },
        "Чаепитие классик \"Ханс\" до 5 гостей, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 9000.0
        },
        "Волшебная палочка, Визардия": {
          "записей": 1,
          "единиц": 6.0,
          "сумма": 7800.0
        }
      },
      "2025-11-27": {
        "Единый билет Визардия, будний день на 2 студентов на 2 студентов Академии": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 3300.0
        },
        "Семейный билет Визардия, будний день на трёх студентов Академии": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 4600.0
        },
        "Чаепитие классик \"Ханс\" до 5 гостей, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 9000.0
        }
      },
      "2025-11-28": {
        "Оплата по смете праздника, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 28020.0
        },
        "Индивидуальная программа \"Отдел тайн\" на 3 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 35000.0
        }
      },
      "2025-11-29": {
        "Оплата по смете праздника, Визардия": {
          "записей": 8,
          "единиц": 8.0,
          "сумма": 158050.0
        },
        "Индивидуальная программа \"Отдел тайн\" на 3 часа, Визардия": {
          "записей": 4,
          "единиц": 4.0,
          "сумма": 123220.0
        },
        "Билет студента академии волшебства Визардия, выходной день 2400": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 4080.0
        },
        "Волшебная палочка, Визардия": {
          "записей": 5,
          "единиц": 13.0,
          "сумма": 16900.0
        },
        "Дополнительный именинник, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 500.0
        },
        "Чаепитие дизайнерский \"Ханс\" до 5 гостей, Визардия": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 32000.0
        },
        "Семейный билет Визардия, выходной день на  на трёх студентов Академии": {
          "записей": 6,
          "единиц": 9.0,
          "сумма": 54000.0
        },
        "Единый билет Визардия,выходной день на 2 студентов Академии": {
          "записей": 3,
          "единиц": 3.0,
          "сумма": 12900.0
        },
        "Чаепитие классик \"Густав\" до 8 гостей, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 12500.0
        },
        "Волшебная палочка Визардия особенная": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 2200.0
        },
        "Чаепитие классик \"Ханс\" до 5 гостей, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 9000.0
        },
        "Чаепитие дизайнерский \"Густав\" до 8 гостей, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 19500.0
        },
        "Билет со скидкой, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 2210.0
        },
        "Пакетное предложение \"Отдел Тайн\", 3 часа": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 35000.0
        }
      },
      "2025-11-30": {
        "Индивидуальная программа \"Отдел тайн\" на 3 часа, Визардия": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 64970.0
        },
        "Волшебная палочка Визардия особенная": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 0.0
        },
        "Бумажная дискотека: Оптима, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 0.0
        },
        "Услуги фотографа на 2 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 0.0
        },
        "Индивидуальная программа \"Трактир: Большое путешествие\" на 3 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 173700.0
        },
        "Оплата по смете праздника, Визардия": {
          "записей": 3,
          "единиц": 3.0,
          "сумма": 56250.0
        },
        "Волшебная палочка, Визардия": {
          "записей": 2,
          "единиц": 9.0,
          "сумма": 11700.0
        },
        "Чаепитие классик \"Густав\" до 8 гостей, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 12500.0
        },
        "Единый билет Визардия,выходной день на 2 студентов Академии": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 4300.0
        },
        "Семейный билет Визардия, выходной день на  на трёх студентов Академии": {
          "записей": 1,
          "единиц": 2.0,
          "сумма": 12000.0
        },
        "Индивидуальная программа \"Трактир\" на 3 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 70000.0
        },
        "Чаепитие классик \"Ханс\" до 5 гостей, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 9000.0
        },
        "Билет студента академии волшебства Визардия, выходной день 2600": {
          "записей": 1,
          "единиц": 2.0,
          "сумма": 4420.0
        }
      },
      "2025-12-02": {
        "Чаепитие классик \"Густав\" до 8 гостей, Визардия": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 25900.0
        },
        "Индивидуальная программа \"Отдел тайн\" на 3 часа, Визардия": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 61170.0
        },
        "Билет на Новогоднее шоу в Визардии 2500": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 2250.0
        },
        "Оплата по смете праздника, Визардия": {
          "записей": 2,
          "единиц": 9.0,
          "сумма": 9000.0
        },
        "Волшебная палочка Визардия особенная": {
          "записей": 2,
          "единиц": 8.0,
          "сумма": 17600.0
        },
        "Семейный билет Визардия, будний день на трёх студентов Академии": {
          "записей": 2,
          "единиц": 3.0,
          "сумма": 13800.0
        }
      },
      "2025-12-04": {
        "Оплата по смете праздника, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 1000.0
        },
        "Чаепитие классик \"Густав\" до 8 гостей, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 12500.0
        },
        "Семейный билет Визардия, будний день на трёх студентов Академии": {
          "записей": 1,
          "единиц": 3.0,
          "сумма": 13800.0
        }
      },
      "2025-12-05": {
        "Чаепитие классик \"Ханс\" до 5 гостей, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 9000.0
        },
        "Волшебная палочка, Визардия": {
          "записей": 1,
          "единиц": 5.0,
          "сумма": 6500.0
        },
        "Единый билет Визардия, будний день на 2 студентов на 2 студентов Академии": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 3300.0
        },
        "Семейный билет Визардия, будний день на трёх студентов Академии": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 4600.0
        },
        "Индивидуальная программа \"Отдел тайн\" на 3 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 35000.0
        },
        "Чаепитие дизайнерский \"Густав\" до 8 гостей, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 19500.0
        },
        "Билет со скидкой, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 2210.0
        },
        "Семейный билет Визардия, выходной день на  на трёх студентов Академии": {
          "записей": 1,
          "единиц": 2.0,
          "сумма": 12000.0
        }
      },
      "2025-12-06": {
        "Оплата по смете праздника, Визардия": {
          "записей": 5,
          "единиц": 5.0,
          "сумма": 65740.0
        },
        "Чаепитие классик \"Ханс\" до 5 гостей, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 9000.0
        },
        "Билет студента академии волшебства Визардия, выходной день 2400": {
          "записей": 1,
          "единиц": 13.0,
          "сумма": 21840.0
        },
        "Волшебная палочка, Визардия": {
          "записей": 4,
          "единиц": 12.0,
          "сумма": 15600.0
        },
        "Чаепитие дизайнерский \"Феликс\" до 12 гостей, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 24000.0
        },
        "Индивидуальная программа \"Отдел тайн\" на 3 часа, Визардия": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 107280.0
        },
        "Единый билет Визардия,выходной день на 2 студентов Академии": {
          "записей": 3,
          "единиц": 3.0,
          "сумма": 12900.0
        },
        "Чаепитие дизайнерский \"Рупперт\" до 15 гостей, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 28000.0
        },
        "Чаепитие классик \"Густав\" до 8 гостей, Визардия": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 25000.0
        },
        "Семейный билет Визардия, выходной день на  на трёх студентов Академии": {
          "записей": 4,
          "единиц": 8.0,
          "сумма": 48000.0
        },
        "Чаепитие дизайнерский \"Густав\" до 8 гостей, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 19500.0
        },
        "Билет студента академии волшебства Визардия, выходной день 2600": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 2210.0
        },
        "Чаепитие классик \"Феликс\" до 12 гостей": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 20500.0
        },
        "Дополнительный именинник, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 1000.0
        }
      },
      "2025-12-07": {
        "Оплата по смете праздника, Визардия": {
          "записей": 5,
          "единиц": 7.0,
          "сумма": 162820.0
        },
        "Волшебная палочка, Визардия": {
          "записей": 4,
          "единиц": 11.0,
          "сумма": 14300.0
        },
        "Депозит для заказа блюд в ресторане, Визардия": {
          "записей": 1,
          "единиц": 10.0,
          "сумма": 10000.0
        },
        "Чаепитие дизайнерский \"Густав\" до 8 гостей, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 19500.0
        },
        "Семейный билет Визардия, выходной день на  на трёх студентов Академии": {
          "записей": 4,
          "единиц": 6.0,
          "сумма": 36000.0
        },
        "Чаепитие классик \"Ханс\" до 5 гостей, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 9000.0
        },
        "Единый билет Визардия,выходной день на 2 студентов Академии": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 4300.0
        },
        "Индивидуальная программа \"Отдел тайн\" на 3 часа, Визардия": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 88650.0
        }
      },
      "2025-12-09": {
        "Оплата по смете праздника, Визардия": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 2300.0
        },
        "Чаепитие классик \"Ханс\" до 5 гостей, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 9000.0
        },
        "Единый билет Визардия, будний день на 2 студентов на 2 студентов Академии": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 3300.0
        },
        "Семейный билет Визардия, будний день на трёх студентов Академии": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 4600.0
        }
      },
      "2025-12-13": {
        "Единый билет Визардия,выходной день на 2 студентов Академии": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 4300.0
        },
        "Семейный билет Визардия, выходной день на  на трёх студентов Академии": {
          "записей": 1,
          "единиц": 2.0,
          "сумма": 12000.0
        },
        "Волшебная палочка, Визардия": {
          "записей": 1,
          "единиц": 3.0,
          "сумма": 3900.0
        },
        "Билет студента академии волшебства Визардия, выходной день 2400": {
          "записей": 1,
          "единиц": 7.0,
          "сумма": 11760.0
        },
        "Индивидуальная программа \"Отдел тайн\" на 3 часа, Визардия": {
          "записей": 3,
          "единиц": 3.0,
          "сумма": 100100.0
        },
        "Пакетное предложение \"Отдел Тайн\", 3 часа": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 35000.0
        }
      },
      "2025-12-14": {
        "Оплата по смете праздника, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 8030.0
        },
        "Архив, Пакетное предложение \"Отдел Тайн\", 3 часа": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 55500.0
        }
      },
      "2025-12-19": {
        "Индивидуальная программа \"Отдел тайн\" на 3 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 35000.0
        },
        "Сытный перекус, Визардия": {
          "записей": 1,
          "единиц": 12.0,
          "сумма": 7080.0
        },
        "Билет на Новогоднее шоу в Визардии 2500": {
          "записей": 1,
          "единиц": 12.0,
          "сумма": 21000.0
        }
      },
      "2025-12-20": {
        "Индивидуальная программа \"Отдел тайн\" на 3 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 35000.0
        }
      },
      "2025-12-21": {
        "Индивидуальная программа \"Трактир\" на 3 часа, Визардия": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 120000.0
        }
      },
      "2025-12-23": {
        "Индивидуальная программа \"Отдел тайн\" на 3 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 20000.0
        }
      },
      "2025-12-24": {
        "Билет на Новогоднее шоу в Визардии 2500": {
          "записей": 1,
          "единиц": 10.0,
          "сумма": 25000.0
        }
      },
      "2025-12-27": {
        "Индивидуальная программа  \"Таверна\" на 3 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 50000.0
        },
        "Индивидуальная программа \"Отдел тайн\" на 3 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 35000.0
        },
        "Индивидуальная программа \"Трактир\" на 3 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 50000.0
        },
        "Билет на Новогоднее шоу в Министерстве магии 3500": {
          "записей": 1,
          "единиц": 8.0,
          "сумма": 28000.0
        }
      },
      "2025-12-28": {
        "Индивидуальная программа \"Отдел тайн\" на 3 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 35000.0
        }
      },
      "2025-12-29": {
        "Индивидуальная программа \"Отдел тайн\" на 3 часа, Визардия": {
          "записей": 2,
          "единиц": 2.0,
          "сумма": 70000.0
        },
        "Депозит для взрослых, Визардия": {
          "записей": 1,
          "единиц": 3.0,
          "сумма": 3000.0
        },
        "Билет на Новогоднее шоу в Визардии 2500": {
          "записей": 1,
          "единиц": 5.0,
          "сумма": 12500.0
        }
      },
      "2025-12-30": {
        "Билет на Новогоднее шоу в Визардии 2500": {
          "записей": 3,
          "единиц": 4.0,
          "сумма": 9750.0
        },
        "Индивидуальная программа  \"Таверна\" на 3 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 50000.0
        }
      },
      "2026-01-03": {
        "Оплата по смете праздника, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 100000.0
        },
        "Баннер, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 20000.0
        },
        "Индивидуальная программа  \"Таверна\" на 3 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 81920.0
        }
      },
      "2026-01-09": {
        "Индивидуальная программа  \"Таверна\" на 3 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 50000.0
        }
      },
      "2026-01-10": {
        "Индивидуальная программа \"Отдел тайн\" на 3 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 35000.0
        }
      },
      "2026-05-22": {
        "Индивидуальная программа  на выпускной \"Таверна\" на 3 часа, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 40000.0
        }
      },
      "2026-05-25": {
        "Оплата по смете праздника, Визардия": {
          "записей": 1,
          "единиц": 1.0,
          "сумма": 27500.0
        }
      }
    };

    let myChart = null;

    // Категории товаров
    const categories = {
      'Кухня': '#5470c6',      // Синий (как в аналитике 1)
      'Аренда': '#91cc75',     // Зеленый
      'Билеты': '#fac858',     // Желтый
      'Палочки': '#ee6666',    // Красный
      'Допуслуги': '#73c0de'   // Голубой
    };

    // Функция для определения категории товара
    function getCategory(itemName) {
      const item = itemName.toLowerCase();

      if (item.includes("чаепи") || item.includes("оплата по смете") || item.includes("смет")) {
        return "Кухня";
      }
      if (item.includes("пакетное предложение") || item.includes("аренда") ||
        item.includes("программа") || item.includes("банкет")) {
        return "Аренда";
      }
      if (item.includes("билет")) {
        return "Билеты";
      }
      if (item.includes("палочк")) {
        return "Палочки";
      }
      return "Допуслуги";
    }

    // Инициализация
    document.addEventListener('DOMContentLoaded', function () {
      // Установка дат по умолчанию
      const dates = Object.keys(products).sort();
      if (dates.length > 0) {
        const startDateInput = document.getElementById('start-date');
        const endDateInput = document.getElementById('end-date');

        startDateInput.value = dates[0];
        endDateInput.value = dates[dates.length - 1];

        // Ограничиваем минимальную и максимальную даты
        startDateInput.min = dates[0];
        startDateInput.max = dates[dates.length - 1];
        endDateInput.min = dates[0];
        endDateInput.max = dates[dates.length - 1];
      }

      // Инициализация графика
      const chartDom = document.getElementById('main');
      myChart = echarts.init(chartDom);
      updateChart();

      // Обработка ресайза с оптимизацией
      let resizeTimer;
      window.addEventListener('resize', function () {
        clearTimeout(resizeTimer);
        resizeTimer = setTimeout(() => {
          if (myChart) {
            myChart.resize();
            updateChart();
          }
        }, 250);
      });
    });

    // Подготовка данных для графика
    function prepareChartData() {
      const startDate = document.getElementById('start-date').value;
      const endDate = document.getElementById('end-date').value;

      // Фильтруем даты
      const filteredDates = Object.keys(products)
        .filter(date => date >= startDate && date <= endDate)
        .sort();

      // Группируем данные по датам и категориям
      const categoriesData = {};
      const detailedData = {}; // Для детализированных данных по товарам
      Object.keys(categories).forEach(category => {
        categoriesData[category] = {};
      });

      // Инициализируем для каждой даты нулевые значения
      filteredDates.forEach(date => {
        Object.keys(categories).forEach(category => {
          categoriesData[category][date] = 0;
        });
        detailedData[date] = {};
      });

      // Собираем данные
      filteredDates.forEach(date => {
        const dayData = products[date] || {};

        // Для каждого товара в этот день
        Object.entries(dayData).forEach(([itemName, itemData]) => {
          const category = getCategory(itemName);
          const sum = itemData.сумма || 0;

          if (categoriesData[category]) {
            categoriesData[category][date] += sum;
            // Сохраняем детализированные данные
            if (!detailedData[date][category]) {
              detailedData[date][category] = [];
            }
            detailedData[date][category].push({
              name: itemName,
              sum: sum,
              units: itemData.единиц || 1
            });
          }
        });
      });

      return { filteredDates, categoriesData, detailedData };
    }

    // Форматирование даты для оси X
    function formatDate(dateStr) {
      const date = new Date(dateStr);
      const day = date.getDate();
      const month = date.getMonth() + 1;
      return `${day.toString().padStart(2, '0')}.${month.toString().padStart(2, '0')}`;
    }

    // Форматирование суммы в читаемый вид
    function formatSum(sum) {
      if (sum >= 1000000) {
        return (sum / 1000000).toFixed(1) + 'M';
      } else if (sum >= 1000) {
        return (sum / 1000).toFixed(0) + 'k';
      }
      return sum.toString();
    }

    // Обновление графика
    function updateChart() {
      if (!myChart) return;

      const chartData = prepareChartData();
      const isMobile = window.innerWidth <= 768;
      const isLandscape = window.innerWidth > window.innerHeight;

      // Форматируем даты для оси X
      const xAxisData = chartData.filteredDates.map(date => formatDate(date));

      // Определяем интервал для меток оси X
      const dateCount = xAxisData.length;
      let xAxisInterval = 0;
      let xAxisRotate = 0;

      if (dateCount > 30) {
        xAxisInterval = Math.floor(dateCount / 15);
        xAxisRotate = isMobile ? 45 : 0;
      } else if (dateCount > 15) {
        xAxisInterval = isMobile ? Math.floor(dateCount / 10) : 0;
        xAxisRotate = isMobile ? 45 : 0;
      }

      // Для ландшафтной ориентации на мобильных устройствах
      if (isMobile && isLandscape) {
        xAxisRotate = 45;
      }

      // Создаем серии для каждой категории
      const series = [];
      const legendData = [];

      Object.entries(categories).forEach(([category, color]) => {
        // Собираем данные для этой категории
        const categoryData = chartData.filteredDates.map((date, index) => {
          const value = chartData.categoriesData[category][date] || 0;

          return {
            value: value / 1000, // Переводим в тысячи рублей
            rawValue: value,
            category: category,
            date: date,
            details: chartData.detailedData[date] ? chartData.detailedData[date][category] || [] : []
          };
        });

        series.push({
          name: category,
          type: 'bar',
          stack: 'total',
          label: {
            show: true,
            position: 'inside',
            formatter: function (params) {
              const value = params.value.rawValue || 0;
              if (value === 0) return '';
              return formatSum(value);
            },
            fontSize: isMobile ? 10 : 11,
            color: '#fff',
            fontWeight: 'bold',
            textShadow: '1px 1px 2px rgba(0,0,0,0.5)',
            distance: 10
          },
          emphasis: {
            focus: 'series'
          },
          itemStyle: {
            color: color
          },
          data: categoryData
        });

        legendData.push(category);
      });

      const option = {
        tooltip: {
          trigger: 'axis',
          axisPointer: {
            type: 'shadow'
          },
          confine: true, // Не выходит за границы контейнера
          appendToBody: true, // Добавляем в body для лучшего позиционирования
          position: function (point, params, dom, rect, size) {
            // Адаптивное позиционирование для мобильных и десктопа
            const isMobile = window.innerWidth <= 768;
            const tooltipWidth = size.contentSize[0];
            const tooltipHeight = size.contentSize[1];
            const viewWidth = size.viewSize[0];
            const viewHeight = size.viewSize[1];

            if (isMobile) {
              // Для мобильных - центрируем по горизонтали, позиционируем сверху
              let x = viewWidth / 2 - tooltipWidth / 2;
              x = Math.max(10, Math.min(x, viewWidth - tooltipWidth - 10));

              // Если тултип слишком высокий, показываем в центре
              if (tooltipHeight > viewHeight * 0.6) {
                return [x, '50%'];
              }
              return [x, '10%'];
            } else {
              // Для десктопа - стандартное позиционирование с коррекцией
              let x = point[0];
              let y = point[1];

              // Корректируем позицию, если выходит за правый край
              if (x + tooltipWidth > viewWidth - 20) {
                x = viewWidth - tooltipWidth - 20;
              }

              // Корректируем позицию, если выходит за нижний край
              if (y + tooltipHeight > viewHeight - 20) {
                y = viewHeight - tooltipHeight - 20;
              }

              return [x, y];
            }
          },
          backgroundColor: 'rgba(255, 255, 255, 0.98)',
          borderColor: '#ddd',
          borderWidth: 1,
          borderRadius: 8,
          padding: 12,
          textStyle: {
            fontSize: isMobile ? 12 : 13,
            lineHeight: 18
          },
          extraCssText: 'box-shadow: 0 4px 20px rgba(0,0,0,0.15); max-width: 95vw; max-height: 80vh; overflow-y: auto;',
          formatter: function (params) {
            const dateIndex = params[0].dataIndex;
            const date = chartData.filteredDates[dateIndex];
            let result = `<div style="font-weight: bold; margin-bottom: 8px; font-size: ${isMobile ? '14px' : '15px'}; color: #333; padding-bottom: 4px; border-bottom: 2px solid #f0f0f0;">${formatDate(date)}</div>`;
            let total = 0;
            let hasData = false;

            params.forEach(param => {
              const category = param.seriesName;
              const color = categories[category];
              const value = param.data.rawValue || 0;
              const details = param.data.details || [];

              if (value > 0) {
                hasData = true;
                total += value;

                const formattedValue = value.toLocaleString('ru-RU');
                result += `
                                    <div style="display: flex; align-items: flex-start; margin: 8px 0; padding: 6px 0;">
                                        <div style="width: 12px; height: 12px; background: ${color}; margin-right: 10px; margin-top: 3px; border-radius: 2px; flex-shrink: 0;"></div>
                                        <div style="flex: 1; min-width: 0;">
                                            <div style="font-weight: 600; color: #333; font-size: ${isMobile ? '13px' : '14px'}; word-wrap: break-word; margin-bottom: 2px;">
                                                ${category}
                                            </div>
                                            <div style="text-align: right; font-weight: 600; color: #333; font-size: ${isMobile ? '13px' : '14px'};">
                                                ${formattedValue} ₽
                                            </div>
                                        </div>
                                    </div>
                                `;

                // Добавляем детали по товарам (только для десктопа и если мало данных)
                if (!isMobile && details.length > 0 && details.length <= 3) {
                  details.forEach(item => {
                    const itemSum = item.sum.toLocaleString('ru-RU');
                    result += `
                                            <div style="font-size: 11px; color: #666; margin-left: 22px; margin-top: 2px; line-height: 1.4; padding-left: 4px; border-left: 2px solid #f0f0f0;">
                                                ${item.name}: ${itemSum} ₽
                                                ${item.units > 1 ? ` (${item.units} шт.)` : ''}
                                            </div>
                                        `;
                  });
                } else if (!isMobile && details.length > 3) {
                  result += `
                                        <div style="font-size: 11px; color: #666; margin-left: 22px; margin-top: 2px; font-style: italic;">
                                            ${details.length} товара(ов)
                                        </div>
                                    `;
                }
              }
            });

            if (!hasData) {
              return `<div style="font-weight: bold; margin-bottom: 8px; font-size: ${isMobile ? '14px' : '15px'}; color: #333;">${formatDate(date)}</div>
                                    <div style="color: #666; font-size: ${isMobile ? '13px' : '14px'}; padding: 8px 0;">Нет данных за этот день</div>`;
            }

            const formattedTotal = total.toLocaleString('ru-RU');
            result += `<div style="border-top: 2px solid #f0f0f0; margin: 10px 0 0 0; padding-top: 10px;">
                                  <div style="display: flex; justify-content: space-between; font-weight: bold; font-size: ${isMobile ? '14px' : '15px'}; color: #333;">
                                      <div>Итого:</div>
                                      <div>${formattedTotal} ₽</div>
                                  </div></div>`;

            return result;
          }
        },
        legend: {
          data: legendData,
          top: 10,
          type: 'scroll',
          textStyle: {
            fontSize: isMobile ? 10 : 12
          },
          itemWidth: isMobile ? 20 : 25,
          itemHeight: isMobile ? 12 : 14,
          pageIconSize: isMobile ? 10 : 12,
          pageTextStyle: {
            fontSize: isMobile ? 10 : 12
          }
        },
        grid: {
          left: '3%',
          right: '4%',
          bottom: isMobile ? '20%' : '15%',
          top: isMobile ? '20%' : '15%',
          containLabel: true
        },
        xAxis: {
          type: 'category',
          data: xAxisData,
          axisTick: {
            show: false
          },
          axisLabel: {
            fontSize: isMobile ? 10 : 12,
            interval: xAxisInterval,
            rotate: xAxisRotate,
            margin: isMobile ? 8 : 10,
            formatter: function (value) {
              return value;
            }
          }
        },
        yAxis: {
          type: 'value',
          name: 'Сумма (тыс. ₽)',
          axisLabel: {
            fontSize: isMobile ? 10 : 12,
            formatter: '{value}k'
          },
          splitLine: {
            show: true
          }
        },
        series: series,
        animation: true,
        animationDuration: 500
      };

      // Убираем подписи на мобильных устройствах, если слишком много данных
      if (isMobile && dateCount > 10) {
        series.forEach(s => {
          s.label.show = false;
        });
      }

      myChart.setOption(option);
    }

    // Экспорт функции для глобального доступа
    window.updateChart = updateChart;
  </script>
</body>

</html>